\begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{1}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
\PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
\PY{k+kn}{import} \PY{n+nn}{math}

\PY{n}{i1} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}
    \PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}
    \PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}
    \PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}
    \PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}
    \PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}
    \PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}
    \PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}
\PY{p}{]}\PY{p}{)}

\PY{n}{i2} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}
    \PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}
    \PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}
    \PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}
    \PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}
    \PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}
    \PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}
    \PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}
\PY{p}{]}\PY{p}{)}

\PY{n}{c1} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}
    \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}
    \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,}
    \PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}
\PY{p}{]}\PY{p}{)}

\PY{n}{c2} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}
    \PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,}
    \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,}
    \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}
\PY{p}{]}\PY{p}{)}

\PY{c+c1}{\PYZsh{}\PYZpc{}\PYZpc{}Módulo de convolucion}
\PY{k}{def} \PY{n+nf}{convolution}\PY{p}{(}\PY{n}{image}\PY{p}{,}\PY{n}{kernel}\PY{p}{)}\PY{p}{:}
    \PY{n}{i\PYZus{}width}\PY{p}{,} \PY{n}{i\PYZus{}height} \PY{o}{=} \PY{n}{image}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{image}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
    \PY{n}{k\PYZus{}width}\PY{p}{,} \PY{n}{k\PYZus{}height} \PY{o}{=} \PY{n}{kernel}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{kernel}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
    \PY{c+c1}{\PYZsh{}filtered = np.zeros\PYZus{}like(image)}
    \PY{c+c1}{\PYZsh{}filtered = np.zeros\PYZus{}like(kernel)}
    \PY{n}{filtered} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{n}{i\PYZus{}width}\PY{o}{\PYZhy{}}\PY{n}{k\PYZus{}width}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{i\PYZus{}height}\PY{o}{\PYZhy{}}\PY{n}{k\PYZus{}height}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
    \PY{c+c1}{\PYZsh{}print(filtered)}
    \PY{k}{for} \PY{n}{y} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{i\PYZus{}height}\PY{p}{)}\PY{p}{:}
        \PY{c+c1}{\PYZsh{}print(y)}
        \PY{k}{if} \PY{n}{y} \PY{o}{+} \PY{n}{k\PYZus{}height} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{n}{i\PYZus{}height}\PY{p}{:}
            \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{i\PYZus{}width}\PY{p}{)}\PY{p}{:}
                \PY{k}{if} \PY{n}{x} \PY{o}{+} \PY{n}{k\PYZus{}width} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{n}{i\PYZus{}width}\PY{p}{:}
                    \PY{n}{weighted\PYZus{}pixel\PYZus{}sum} \PY{o}{=} \PY{l+m+mi}{0}
                    \PY{c+c1}{\PYZsh{}print(range(\PYZhy{}(k\PYZus{}height // 2), k\PYZus{}height \PYZhy{} 1))}
                    \PY{n}{y\PYZus{}displ}\PY{o}{=}\PY{l+m+mi}{0}
                    \PY{k}{for} \PY{n}{ky} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{p}{(}\PY{n}{k\PYZus{}height} \PY{o}{/}\PY{o}{/} \PY{l+m+mi}{2}\PY{p}{)}\PY{p}{,} \PY{n}{k\PYZus{}height} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
                        \PY{c+c1}{\PYZsh{}print(\PYZdq{}ky: \PYZdq{},ky)}
                        \PY{n}{x\PYZus{}displ}\PY{o}{=}\PY{l+m+mi}{0}
                        \PY{k}{for} \PY{n}{kx} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{p}{(}\PY{n}{k\PYZus{}width} \PY{o}{/}\PY{o}{/} \PY{l+m+mi}{2}\PY{p}{)}\PY{p}{,} \PY{n}{k\PYZus{}width} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
                            \PY{n}{pixel} \PY{o}{=} \PY{n}{image}\PY{p}{[}\PY{n}{y}\PY{o}{+}\PY{n}{y\PYZus{}displ}\PY{p}{,}\PY{n}{x}\PY{o}{+}\PY{n}{x\PYZus{}displ}\PY{p}{]}
                            \PY{c+c1}{\PYZsh{}print(\PYZdq{}pixel: \PYZdq{},pixel)}
                            \PY{n}{weight} \PY{o}{=} \PY{n}{kernel}\PY{p}{[}\PY{n}{ky} \PY{o}{+} \PY{p}{(}\PY{n}{k\PYZus{}height} \PY{o}{/}\PY{o}{/} \PY{l+m+mi}{2}\PY{p}{)}\PY{p}{,} \PY{n}{kx} \PY{o}{+} \PY{p}{(}\PY{n}{k\PYZus{}width} \PY{o}{/}\PY{o}{/} \PY{l+m+mi}{2}\PY{p}{)}\PY{p}{]}
                            \PY{c+c1}{\PYZsh{}print(\PYZdq{}weight: \PYZdq{},weight)}
                            \PY{n}{weighted\PYZus{}pixel\PYZus{}sum} \PY{o}{+}\PY{o}{=} \PY{n}{pixel} \PY{o}{*} \PY{n}{weight}
                            \PY{n}{x\PYZus{}displ} \PY{o}{+}\PY{o}{=}\PY{l+m+mi}{1}
                        \PY{n}{y\PYZus{}displ}\PY{o}{+}\PY{o}{=}\PY{l+m+mi}{1}
                    \PY{n}{filtered}\PY{p}{[}\PY{n}{y}\PY{p}{,}\PY{n}{x}\PY{p}{]} \PY{o}{=} \PY{n+nb}{max}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{weighted\PYZus{}pixel\PYZus{}sum}\PY{p}{)}
    \PY{k}{return} \PY{n}{filtered}

\PY{n}{i1\PYZus{}conv1} \PY{o}{=} \PY{n}{convolution}\PY{p}{(}\PY{n}{i1}\PY{p}{,}\PY{n}{c1}\PY{p}{)}
\PY{n}{i1\PYZus{}conv2} \PY{o}{=} \PY{n}{convolution}\PY{p}{(}\PY{n}{i1}\PY{p}{,}\PY{n}{c2}\PY{p}{)}
\PY{n}{i2\PYZus{}conv1} \PY{o}{=} \PY{n}{convolution}\PY{p}{(}\PY{n}{i2}\PY{p}{,}\PY{n}{c1}\PY{p}{)}
\PY{n}{i2\PYZus{}conv2} \PY{o}{=} \PY{n}{convolution}\PY{p}{(}\PY{n}{i2}\PY{p}{,}\PY{n}{c2}\PY{p}{)}
\PY{c+c1}{\PYZsh{}print(i1\PYZus{}conv1)}

\PY{c+c1}{\PYZsh{}\PYZpc{}\PYZpc{} Etapa de reducción de datos}
\PY{k}{def} \PY{n+nf}{max\PYZus{}pooling}\PY{p}{(}\PY{n}{conv}\PY{p}{,}\PY{n}{window}\PY{p}{)}\PY{p}{:}
    \PY{c+c1}{\PYZsh{}print(window)}
    \PY{n}{i\PYZus{}width}\PY{p}{,} \PY{n}{i\PYZus{}height} \PY{o}{=} \PY{n}{conv}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{conv}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
    \PY{n}{w\PYZus{}width}\PY{p}{,} \PY{n}{w\PYZus{}height} \PY{o}{=} \PY{n}{window}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{window}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
    \PY{n}{reduction} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{n}{i\PYZus{}width}\PY{o}{\PYZhy{}}\PY{n}{w\PYZus{}width}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{i\PYZus{}height}\PY{o}{\PYZhy{}}\PY{n}{w\PYZus{}height}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
    \PY{k}{for} \PY{n}{y} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{i\PYZus{}height}\PY{p}{)}\PY{p}{:}
        \PY{c+c1}{\PYZsh{}print(y)}
        \PY{k}{if} \PY{n}{y} \PY{o}{+} \PY{n}{w\PYZus{}height} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{n}{i\PYZus{}height}\PY{p}{:}
            \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{i\PYZus{}width}\PY{p}{)}\PY{p}{:}
                \PY{k}{if} \PY{n}{x} \PY{o}{+} \PY{n}{w\PYZus{}width} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{n}{i\PYZus{}width}\PY{p}{:}
                    \PY{n}{max\PYZus{}val} \PY{o}{=} \PY{l+m+mi}{0}
                    \PY{c+c1}{\PYZsh{}print(range(\PYZhy{}(k\PYZus{}height // 2), k\PYZus{}height \PYZhy{} 1))}
                    \PY{n}{y\PYZus{}displ}\PY{o}{=}\PY{l+m+mi}{0}
                    \PY{k}{for} \PY{n}{ky} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{p}{(}\PY{n}{w\PYZus{}height} \PY{o}{/}\PY{o}{/} \PY{l+m+mi}{2}\PY{p}{)}\PY{p}{,} \PY{n}{w\PYZus{}height} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
                        \PY{c+c1}{\PYZsh{}print(\PYZdq{}ky: \PYZdq{},ky)}
                        \PY{n}{x\PYZus{}displ}\PY{o}{=}\PY{l+m+mi}{0}
                        \PY{k}{for} \PY{n}{kx} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{p}{(}\PY{n}{w\PYZus{}width} \PY{o}{/}\PY{o}{/} \PY{l+m+mi}{2}\PY{p}{)}\PY{p}{,} \PY{n}{w\PYZus{}width} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
                            \PY{n}{pixel} \PY{o}{=} \PY{n}{conv}\PY{p}{[}\PY{n}{y}\PY{o}{+}\PY{n}{y\PYZus{}displ}\PY{p}{,}\PY{n}{x}\PY{o}{+}\PY{n}{x\PYZus{}displ}\PY{p}{]}
                            \PY{c+c1}{\PYZsh{}print(\PYZdq{}weight: \PYZdq{},weight)}
                            \PY{k}{if} \PY{n}{pixel} \PY{o}{\PYZgt{}} \PY{n}{max\PYZus{}val}\PY{p}{:}
                                \PY{n}{max\PYZus{}val} \PY{o}{=} \PY{n}{pixel}
                        \PY{n}{y\PYZus{}displ}\PY{o}{+}\PY{o}{=}\PY{l+m+mi}{1}
                    \PY{n}{reduction}\PY{p}{[}\PY{n}{y}\PY{p}{,}\PY{n}{x}\PY{p}{]} \PY{o}{=} \PY{n}{max\PYZus{}val}
    \PY{k}{return} \PY{n}{reduction}

\PY{c+c1}{\PYZsh{}\PYZpc{}\PYZpc{}Etapa deformación del vector descriptor}
\PY{k}{def} \PY{n+nf}{gen\PYZus{}desc\PYZus{}vect}\PY{p}{(}\PY{n}{w1}\PY{p}{,}\PY{n}{w2}\PY{p}{)}\PY{p}{:}
    \PY{n}{descript\PYZus{}vec1} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{n}{w1}\PY{p}{,}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
    \PY{n}{descript\PYZus{}vec2} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{n}{w2}\PY{p}{,}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
    \PY{c+c1}{\PYZsh{}print(descript\PYZus{}vec1)}
    \PY{c+c1}{\PYZsh{}print(descript\PYZus{}vec2)}
    \PY{k}{return} \PY{n}{np}\PY{o}{.}\PY{n}{concatenate}\PY{p}{(}\PY{p}{(}\PY{n}{descript\PYZus{}vec1}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{descript\PYZus{}vec2}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{)}

\PY{n}{window} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}
\PY{n}{mw1} \PY{o}{=} \PY{n}{max\PYZus{}pooling}\PY{p}{(}\PY{n}{i1\PYZus{}conv1}\PY{p}{,}\PY{n}{window}\PY{p}{)}
\PY{n}{mw2} \PY{o}{=} \PY{n}{max\PYZus{}pooling}\PY{p}{(}\PY{n}{i1\PYZus{}conv2}\PY{p}{,}\PY{n}{window}\PY{p}{)}
\PY{n}{mw3} \PY{o}{=} \PY{n}{max\PYZus{}pooling}\PY{p}{(}\PY{n}{i2\PYZus{}conv1}\PY{p}{,}\PY{n}{window}\PY{p}{)}
\PY{n}{mw4} \PY{o}{=} \PY{n}{max\PYZus{}pooling}\PY{p}{(}\PY{n}{i2\PYZus{}conv2}\PY{p}{,}\PY{n}{window}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Vectores generados:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{v1} \PY{o}{=} \PY{n}{gen\PYZus{}desc\PYZus{}vect}\PY{p}{(}\PY{n}{mw1}\PY{p}{,}\PY{n}{mw2}\PY{p}{)}
\PY{n}{v2} \PY{o}{=} \PY{n}{gen\PYZus{}desc\PYZus{}vect}\PY{p}{(}\PY{n}{mw3}\PY{p}{,}\PY{n}{mw4}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{v1}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{v2}\PY{p}{)}

\PY{c+c1}{\PYZsh{}Perceptron}

\PY{n}{err\PYZus{}vector} \PY{o}{=} \PY{p}{[}\PY{p}{]} \PY{c+c1}{\PYZsh{}vector de error}
\PY{n}{w\PYZus{}f} \PY{o}{=} \PY{p}{[}\PY{p}{]} \PY{c+c1}{\PYZsh{}vector de pesos finales}
\PY{c+c1}{\PYZsh{}entradas}
\PY{n}{x} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{n}{v1}\PY{p}{,}\PY{n}{v2}\PY{p}{]}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Entradas:}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+si}{\PYZob{}}\PY{n}{x}\PY{l+s+si}{\PYZcb{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{c+c1}{\PYZsh{}target}
\PY{n}{class\PYZus{}dict} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{:}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{B}\PY{l+s+s2}{\PYZdq{}}\PY{p}{\PYZcb{}}
\PY{n}{t} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{]}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Target:}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+si}{\PYZob{}}\PY{n}{t}\PY{l+s+si}{\PYZcb{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{k}{for} \PY{n}{val} \PY{o+ow}{in} \PY{n}{t}\PY{p}{:}
    \PY{n+nb}{print}\PY{p}{(}\PY{n}{class\PYZus{}dict}\PY{p}{[}\PY{n}{val}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{]}\PY{p}{)}
\PY{c+c1}{\PYZsh{}aprendizaje}
\PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.25}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Alpha:}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+si}{\PYZob{}}\PY{n}{alpha}\PY{l+s+si}{\PYZcb{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{bias} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{shape}\PY{p}{(}\PY{n}{x}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{c+c1}{\PYZsh{}[0] \PYZhy{}\PYZgt{} columnas      [1] \PYZhy{}\PYZgt{} filas}
\PY{n}{bias} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{ones}\PY{p}{(}\PY{p}{(}\PY{n}{bias}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)} \PY{c+c1}{\PYZsh{} np.ones((filas,columnas))}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Bias:}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+si}{\PYZob{}}\PY{n}{bias}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{c+c1}{\PYZsh{}concatenar x con bias \PYZdq{}Vector Aumentado}
\PY{n}{x} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{concatenate}\PY{p}{(}\PY{p}{[}\PY{n}{x}\PY{p}{,} \PY{n}{bias}\PY{p}{]}\PY{p}{,} \PY{n}{axis} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{)} \PY{c+c1}{\PYZsh{}1 \PYZhy{}\PYZgt{} añade a la derecha   0 \PYZhy{}\PYZgt{} añade abajo}
\PY{c+c1}{\PYZsh{}print(f\PYZdq{}Matriz Aumentada:\PYZbs{}n\PYZob{}x\PYZcb{}\PYZbs{}n\PYZdq{})}
\PY{c+c1}{\PYZsh{}matriz de pesos propuesta}
\PY{n}{w\PYZus{}i} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{p}{[}\PY{l+m+mf}{0.1}\PY{p}{]}\PY{p}{,}\PY{p}{[}\PY{l+m+mf}{0.1}\PY{p}{]}\PY{p}{,}\PY{p}{[}\PY{l+m+mf}{0.1}\PY{p}{]}\PY{p}{,}\PY{p}{[}\PY{l+m+mf}{0.1}\PY{p}{]}\PY{p}{,}\PY{p}{[}\PY{l+m+mf}{0.1}\PY{p}{]}\PY{p}{,}\PY{p}{[}\PY{l+m+mf}{0.1}\PY{p}{]}\PY{p}{,}\PY{p}{[}\PY{l+m+mf}{0.1}\PY{p}{]}\PY{p}{,}\PY{p}{[}\PY{l+m+mf}{0.1}\PY{p}{]}\PY{p}{,}\PY{p}{[}\PY{l+m+mf}{0.1}\PY{p}{]}
\PY{p}{,}\PY{p}{[}\PY{l+m+mf}{0.1}\PY{p}{]}\PY{p}{,}\PY{p}{[}\PY{l+m+mf}{0.1}\PY{p}{]}\PY{p}{,}\PY{p}{[}\PY{l+m+mf}{0.1}\PY{p}{]}\PY{p}{,}\PY{p}{[}\PY{l+m+mf}{0.1}\PY{p}{]}\PY{p}{,}\PY{p}{[}\PY{l+m+mf}{0.1}\PY{p}{]}\PY{p}{,}\PY{p}{[}\PY{l+m+mf}{0.1}\PY{p}{]}\PY{p}{,}\PY{p}{[}\PY{l+m+mf}{0.1}\PY{p}{]}\PY{p}{,}\PY{p}{[}\PY{l+m+mf}{0.1}\PY{p}{]}\PY{p}{,}\PY{p}{[}\PY{l+m+mf}{0.1}\PY{p}{]}\PY{p}{,}\PY{p}{[}\PY{l+m+mf}{0.1}\PY{p}{]}
\PY{p}{,}\PY{p}{[}\PY{l+m+mf}{0.1}\PY{p}{]}\PY{p}{,}\PY{p}{[}\PY{l+m+mf}{0.1}\PY{p}{]}\PY{p}{,}\PY{p}{[}\PY{l+m+mf}{0.1}\PY{p}{]}\PY{p}{,}\PY{p}{[}\PY{l+m+mf}{0.1}\PY{p}{]}\PY{p}{,}\PY{p}{[}\PY{l+m+mf}{0.1}\PY{p}{]}\PY{p}{,}\PY{p}{[}\PY{l+m+mf}{0.1}\PY{p}{]}\PY{p}{,}\PY{p}{[}\PY{l+m+mf}{0.1}\PY{p}{]}\PY{p}{,}\PY{p}{[}\PY{l+m+mf}{0.1}\PY{p}{]}\PY{p}{,}\PY{p}{[}\PY{l+m+mf}{0.1}\PY{p}{]}\PY{p}{,}\PY{p}{[}\PY{l+m+mf}{0.1}\PY{p}{]}
\PY{p}{,}\PY{p}{[}\PY{l+m+mf}{0.1}\PY{p}{]}\PY{p}{,}\PY{p}{[}\PY{l+m+mf}{0.1}\PY{p}{]}\PY{p}{,}\PY{p}{[}\PY{l+m+mf}{0.1}\PY{p}{]}\PY{p}{,}\PY{p}{[}\PY{l+m+mf}{0.1}\PY{p}{]} \PY{p}{]}\PY{p}{)}
\PY{n}{w\PYZus{}ini} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{n}{w\PYZus{}i}\PY{p}{)}
\PY{c+c1}{\PYZsh{}w\PYZus{}i = np.random.randn(3, 1) \PYZsh{}matriz de pesos aleatorios}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Matriz de pesos propuesta:}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+si}{\PYZob{}}\PY{n}{w\PYZus{}i}\PY{l+s+si}{\PYZcb{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{c+c1}{\PYZsh{} Regla del perceptrón}

\PY{c+c1}{\PYZsh{} Producto vectorial punto}
\PY{n}{a} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{w\PYZus{}i}\PY{p}{)}
\PY{c+c1}{\PYZsh{}print(f\PYZdq{}a:\PYZbs{}n\PYZob{}a\PYZcb{}\PYZbs{}n\PYZdq{})}

\PY{c+c1}{\PYZsh{}Funcion sigmoide}
\PY{n}{y} \PY{o}{=} \PY{l+m+mi}{1}\PY{o}{/}\PY{p}{(}\PY{l+m+mi}{1} \PY{o}{+} \PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{o}{*}\PY{n}{a}\PY{p}{)}\PY{p}{)}

\PY{c+c1}{\PYZsh{}Error cuadratico medio}
\PY{n}{err} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{l+m+mf}{0.5} \PY{o}{*} \PY{p}{(}\PY{n}{t} \PY{o}{\PYZhy{}} \PY{n}{y}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}

\PY{n}{epoch} \PY{o}{=} \PY{l+m+mi}{0}
\PY{n}{epocas} \PY{o}{=} \PY{l+m+mi}{5000}

\PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range} \PY{p}{(}\PY{n}{epocas}\PY{p}{)}\PY{p}{:}
    \PY{n}{epoch} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
    \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{shape}\PY{p}{(}\PY{n}{x}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{:} \PY{c+c1}{\PYZsh{}Repetir segun la cantidad de filas de x}
        \PY{c+c1}{\PYZsh{} Producto punto}
        \PY{n}{a} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{x}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,} \PY{n}{w\PYZus{}i}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}Funcion sigmoide}
        \PY{n}{y}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{1}\PY{o}{/}\PY{p}{(}\PY{l+m+mi}{1} \PY{o}{+} \PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{o}{*}\PY{n}{a}\PY{p}{)}\PY{p}{)}
        \PY{c+c1}{\PYZsh{} Actualización de pesos}
        \PY{c+c1}{\PYZsh{}print(\PYZdq{}shape x[i]: 3\PYZdq{},np.shape(x[i]))}
        \PY{n}{x\PYZus{}p} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{n}{x}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,} \PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{w\PYZus{}i}\PY{p}{)}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)} \PY{c+c1}{\PYZsh{}REACOMODA np.reshape(matriz,(filas,columnas))}
        \PY{c+c1}{\PYZsh{}w\PYZus{}n = w\PYZus{}i + alpha * (t[i] \PYZhy{} y[i]) * x\PYZus{}p}
        \PY{n}{w\PYZus{}n} \PY{o}{=} \PY{n}{w\PYZus{}i} \PY{o}{\PYZhy{}} \PY{n}{alpha} \PY{o}{*} \PY{n}{y}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{*} \PY{p}{(}\PY{l+m+mi}{1} \PY{o}{\PYZhy{}} \PY{n}{y}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}\PY{o}{*}\PY{p}{(}\PY{n}{y}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{t}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)} \PY{o}{*} \PY{n}{x\PYZus{}p}
        \PY{n}{w\PYZus{}i} \PY{o}{=} \PY{n}{w\PYZus{}n}
        \PY{c+c1}{\PYZsh{}print(f\PYZdq{}Peso nuevo:\PYZbs{}n\PYZob{}w\PYZus{}i\PYZcb{}\PYZbs{}n\PYZdq{})}
    \PY{c+c1}{\PYZsh{} Función de costo \PYZhy{}\PYZhy{} MSE Error cuadrático medio}
    \PY{n}{err} \PY{o}{=} \PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{l+m+mf}{0.5} \PY{o}{*} \PY{p}{(}\PY{n}{t} \PY{o}{\PYZhy{}} \PY{n}{y}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)} \PY{o}{/} \PY{n+nb}{len}\PY{p}{(}\PY{n}{t}\PY{p}{)}
    \PY{n}{err\PYZus{}vector}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{err}\PY{p}{)}
    \PY{c+c1}{\PYZsh{}print(f\PYZdq{}Error:\PYZbs{}n\PYZob{}err\PYZcb{}\PYZbs{}n\PYZdq{})}
    \PY{c+c1}{\PYZsh{}Se añade al vector de pesos}
    \PY{n}{w\PYZus{}f}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{w\PYZus{}i}\PY{p}{)}
    \PY{c+c1}{\PYZsh{}print(f\PYZdq{}Vector de Pesos Finales:\PYZbs{}n\PYZob{}w\PYZus{}f\PYZcb{}\PYZbs{}n\PYZdq{})}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Vectores generados:
[0. 1. 2. 1. 1. 2. 2. 0. 1. 2. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 1. 1. 0. 0. 1. 1. 0. 0.]
[1. 1. 0. 0. 1. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 1. 2. 0. 0.
 1. 2. 2. 0. 0. 1. 2. 1.]
Entradas:
[[0. 1. 2. 1. 1. 2. 2. 0. 1. 2. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
  1. 1. 0. 0. 1. 1. 0. 0.]
 [1. 1. 0. 0. 1. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 1. 2. 0. 0.
  1. 2. 2. 0. 0. 1. 2. 1.]]

Target:
[[0]
 [1]]

A
B
Alpha:
0.25

Bias:
[[-1.]
 [-1.]]
Matriz de pesos propuesta:
[[0.1]
 [0.1]
 [0.1]
 [0.1]
 [0.1]
 [0.1]
 [0.1]
 [0.1]
 [0.1]
 [0.1]
 [0.1]
 [0.1]
 [0.1]
 [0.1]
 [0.1]
 [0.1]
 [0.1]
 [0.1]
 [0.1]
 [0.1]
 [0.1]
 [0.1]
 [0.1]
 [0.1]
 [0.1]
 [0.1]
 [0.1]
 [0.1]
 [0.1]
 [0.1]
 [0.1]
 [0.1]
 [0.1]]

    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{2}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\PY{c+c1}{\PYZsh{}Pesos Finales}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{Pesos finales: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
    \PY{n}{res} \PY{o}{=} \PY{n+nb}{str}\PY{p}{(}\PY{n}{w\PYZus{}i}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{n}{res}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{p}{)}

\PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\PY{c+c1}{\PYZsh{} Displaying Results}
\PY{k}{def} \PY{n+nf}{predict}\PY{p}{(}\PY{n}{X}\PY{p}{)}\PY{p}{:}
    \PY{k}{if} \PY{n}{X} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{:}
      \PY{k}{return} \PY{l+m+mi}{1}
    \PY{k}{else}\PY{p}{:}
      \PY{k}{return} \PY{l+m+mi}{0}

\PY{n}{a} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{w\PYZus{}i}\PY{p}{)}
\PY{n}{y} \PY{o}{=} \PY{l+m+mi}{1}\PY{o}{/}\PY{p}{(}\PY{l+m+mi}{1} \PY{o}{+} \PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{o}{*}\PY{n}{a}\PY{p}{)}\PY{p}{)}

\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{PERCEPTRÓN SIGMOIDE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Meta:    Predicción:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{y}\PY{p}{)}\PY{p}{)}\PY{p}{:}
    \PY{n}{res} \PY{o}{=} \PY{n+nb}{str}\PY{p}{(}\PY{n}{class\PYZus{}dict}\PY{p}{[}\PY{n}{t}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{]}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{class\PYZus{}dict}\PY{p}{[}\PY{n}{predict}\PY{p}{(}\PY{n}{y}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{]}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{n}{res}\PY{p}{)}

\PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{Épocas requeridas: }\PY{l+s+si}{\PYZob{}}\PY{n}{epoch}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]

Pesos finales:
[[ 0.36689862]
 [ 0.00857441]
 [-0.61664842]
 [-0.25832421]
 [ 0.00857441]
 [-0.3497498 ]
 [-0.61664842]
 [ 0.1       ]
 [-0.25832421]
 [-0.61664842]
 [ 0.1       ]
 [ 0.1       ]
 [-0.25832421]
 [ 0.1       ]
 [ 0.1       ]
 [ 0.1       ]
 [ 0.36689862]
 [ 0.1       ]
 [ 0.1       ]
 [ 0.1       ]
 [ 0.36689862]
 [ 0.63379725]
 [ 0.1       ]
 [ 0.1       ]
 [ 0.00857441]
 [ 0.27547304]
 [ 0.63379725]
 [ 0.1       ]
 [-0.25832421]
 [ 0.00857441]
 [ 0.63379725]
 [ 0.36689862]
 [ 0.19142559]]

PERCEPTRÓN SIGMOIDE
Meta:    Predicción:
A--------A
B--------B

Épocas requeridas: 5000.
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{3}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{}Se calcula la salida de las imagenes}
\PY{n}{i1} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}
\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}
\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}
\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}
\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}
\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}
\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{]}\PY{p}{)}

\PY{n}{i2} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}
\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}
\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}
\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}
\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}
\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}
\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{]}\PY{p}{)}

\PY{n}{i1\PYZus{}conv1} \PY{o}{=} \PY{n}{convolution}\PY{p}{(}\PY{n}{i1}\PY{p}{,}\PY{n}{c1}\PY{p}{)}
\PY{n}{i1\PYZus{}conv2} \PY{o}{=} \PY{n}{convolution}\PY{p}{(}\PY{n}{i1}\PY{p}{,}\PY{n}{c2}\PY{p}{)}
\PY{n}{i2\PYZus{}conv1} \PY{o}{=} \PY{n}{convolution}\PY{p}{(}\PY{n}{i2}\PY{p}{,}\PY{n}{c1}\PY{p}{)}
\PY{n}{i2\PYZus{}conv2} \PY{o}{=} \PY{n}{convolution}\PY{p}{(}\PY{n}{i2}\PY{p}{,}\PY{n}{c2}\PY{p}{)}
\PY{n}{mw1} \PY{o}{=} \PY{n}{max\PYZus{}pooling}\PY{p}{(}\PY{n}{i1\PYZus{}conv1}\PY{p}{,}\PY{n}{window}\PY{p}{)}
\PY{n}{mw2} \PY{o}{=} \PY{n}{max\PYZus{}pooling}\PY{p}{(}\PY{n}{i1\PYZus{}conv2}\PY{p}{,}\PY{n}{window}\PY{p}{)}
\PY{n}{mw3} \PY{o}{=} \PY{n}{max\PYZus{}pooling}\PY{p}{(}\PY{n}{i2\PYZus{}conv1}\PY{p}{,}\PY{n}{window}\PY{p}{)}
\PY{n}{mw4} \PY{o}{=} \PY{n}{max\PYZus{}pooling}\PY{p}{(}\PY{n}{i2\PYZus{}conv2}\PY{p}{,}\PY{n}{window}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Vectores generados:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{v1} \PY{o}{=} \PY{n}{gen\PYZus{}desc\PYZus{}vect}\PY{p}{(}\PY{n}{mw1}\PY{p}{,}\PY{n}{mw2}\PY{p}{)}
\PY{n}{v2} \PY{o}{=} \PY{n}{gen\PYZus{}desc\PYZus{}vect}\PY{p}{(}\PY{n}{mw3}\PY{p}{,}\PY{n}{mw4}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{v1}\PY{p}{,}\PY{n}{v2}\PY{p}{)}
\PY{n}{x} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{n}{v1}\PY{p}{,}\PY{n}{v2}\PY{p}{]}\PY{p}{)}
\PY{c+c1}{\PYZsh{}concatenar x con bias \PYZdq{}Vector Aumentado}
\PY{n}{bias} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{shape}\PY{p}{(}\PY{n}{x}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{c+c1}{\PYZsh{}[0] \PYZhy{}\PYZgt{} columnas      [1] \PYZhy{}\PYZgt{} filas}
\PY{n}{bias} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{ones}\PY{p}{(}\PY{p}{(}\PY{n}{bias}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)} \PY{c+c1}{\PYZsh{} np.ones((filas,columnas))}
\PY{c+c1}{\PYZsh{}print(f\PYZdq{}Bias:\PYZbs{}n\PYZob{}bias\PYZcb{}\PYZdq{})}
\PY{n}{x\PYZus{}aum} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{concatenate}\PY{p}{(}\PY{p}{[}\PY{n}{x}\PY{p}{,} \PY{n}{bias}\PY{p}{]}\PY{p}{,} \PY{n}{axis} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{)}
\PY{c+c1}{\PYZsh{} Producto vectorial punto}
\PY{n}{a} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{x\PYZus{}aum}\PY{p}{,} \PY{n}{w\PYZus{}i}\PY{p}{)}
\PY{c+c1}{\PYZsh{}print(f\PYZdq{}a:\PYZbs{}n\PYZob{}a\PYZcb{}\PYZbs{}n\PYZdq{})}
\PY{c+c1}{\PYZsh{}Funcion sigmoide}
\PY{n}{y} \PY{o}{=} \PY{l+m+mi}{1}\PY{o}{/}\PY{p}{(}\PY{l+m+mi}{1} \PY{o}{+} \PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{o}{*}\PY{n}{a}\PY{p}{)}\PY{p}{)}
\PY{c+c1}{\PYZsh{}print(f\PYZdq{}y:\PYZbs{}n\PYZob{}y\PYZcb{}\PYZbs{}n\PYZdq{})}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Determinación de clase}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Punto:    Predicción:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{y}\PY{p}{)}\PY{p}{)}\PY{p}{:}
    \PY{n}{res} \PY{o}{=} \PY{n+nb}{str}\PY{p}{(}\PY{n}{x}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{class\PYZus{}dict}\PY{p}{[}\PY{n}{predict}\PY{p}{(}\PY{n}{y}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{]}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{n}{res}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Vectores generados:
[0. 0. 0. 1. 0. 0. 1. 2. 0. 1. 2. 2. 0. 1. 2. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 1. 1. 0.] [0. 1. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
2. 0. 0. 1. 2. 2.
 0. 0. 1. 2. 0. 0. 0. 1.]
Determinación de clase
Punto:    Predicción:
[0. 0. 0. 1. 0. 0. 1. 2. 0. 1. 2. 2. 0. 1. 2. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 1. 1. 0.]--------A
[0. 1. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 2. 0. 0. 1. 2. 2.
 0. 0. 1. 2. 0. 0. 0. 1.]--------B
    \end{Verbatim}